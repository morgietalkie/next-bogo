"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var filesize_1 = __importDefault(require("filesize"));
var react_1 = __importDefault(require("react"));
var io_1 = require("react-icons/io");
var react_redux_1 = require("react-redux");
var AssetSourceDispatchContext_1 = require("../../contexts/AssetSourceDispatchContext");
var useTypedSelector_1 = __importDefault(require("../../hooks/useTypedSelector"));
var assets_1 = require("../../modules/assets");
var dialog_1 = require("../../modules/dialog");
var Box_1 = __importDefault(require("../../styled/Box"));
var Button_1 = __importDefault(require("../Button/Button"));
var Footer = function () {
    var _a, _b;
    var onSelect = AssetSourceDispatchContext_1.useAssetSourceActions().onSelect;
    // Redux
    var dispatch = react_redux_1.useDispatch();
    var byIds = useTypedSelector_1.default(function (state) { return state.assets.byIds; });
    var items = byIds ? Object.values(byIds) : [];
    var picked = items && items.filter(function (item) { return item.picked; });
    var singlePickedAsset = picked && picked.length === 1 ? (_a = picked[0]) === null || _a === void 0 ? void 0 : _a.asset : undefined;
    var handleDownloadOriginal = function (asset) {
        window.location.href = asset.url + "?dl";
    };
    return (react_1.default.createElement(Box_1.default, { alignItems: "center", bg: "darkestGray", bottom: 0, display: "flex", flexWrap: "wrap", justifyContent: "space-between", left: 0, position: "fixed", textColor: "lighterGray", width: "100%" },
        react_1.default.createElement(Box_1.default, { alignItems: "center", display: "flex", flex: "3 0", height: "headerRowHeight", order: [2, 0] }, picked.length > 0 && (react_1.default.createElement(Box_1.default, { display: "flex", height: "100%" },
            react_1.default.createElement(Button_1.default, { onClick: function () { return dispatch(assets_1.assetsDeletePicked()); }, variant: "danger" },
                "Delete",
                picked.length > 1 ? " " + picked.length + " images" : '')))),
        react_1.default.createElement(Box_1.default, { height: "headerRowHeight", order: [0, 1], overflow: "hidden", width: ['100%', 'auto'] },
            singlePickedAsset && (react_1.default.createElement(Box_1.default, { alignItems: "center", display: "flex", height: "100%", justifyContent: ['space-between', 'center'], width: "100%" },
                react_1.default.createElement(Box_1.default, { alignItems: "center", display: "flex", flexDirection: "row", ml: [2, 0], minWidth: 0, whiteSpace: "nowrap" },
                    react_1.default.createElement(Box_1.default, { maxWidth: [null, '420px'], mx: 2, overflow: "hidden", textColor: "lightGray", textOverflow: "ellipsis" },
                        react_1.default.createElement("strong", null, singlePickedAsset.originalFilename)),
                    ((_b = singlePickedAsset.metadata) === null || _b === void 0 ? void 0 : _b.dimensions) && (react_1.default.createElement(Box_1.default, { color: "lightGray", mx: 2 },
                        singlePickedAsset.metadata.dimensions.width,
                        " x",
                        ' ',
                        singlePickedAsset.metadata.dimensions.height)),
                    react_1.default.createElement(Box_1.default, { color: "lightGray", mx: 2 }, filesize_1.default(singlePickedAsset.size, { round: 0 })),
                    react_1.default.createElement(Box_1.default, { borderColor: "lightGray", borderStyle: "solid", borderWidth: "1px", borderRadius: "2px", display: ['none', 'block'], fontSize: 1, mx: 2, px: 1, textColor: "lightGray" }, singlePickedAsset.extension.toUpperCase())),
                react_1.default.createElement(Box_1.default, { alignItems: "center", display: "flex", height: "100%", ml: [0, 2] },
                    react_1.default.createElement(Button_1.default, { icon: io_1.IoIosLink({ size: 16 }), onClick: function () { return dispatch(dialog_1.dialogShowRefs(singlePickedAsset)); } }),
                    react_1.default.createElement(Button_1.default, { icon: io_1.IoIosDownload({ size: 16 }), onClick: handleDownloadOriginal.bind(null, singlePickedAsset) })))),
            picked.length > 1 && (react_1.default.createElement(Box_1.default, { alignItems: "center", display: "flex", height: "headerRowHeight", mx: 3, textColor: "lighterGray" },
                picked.length,
                " images selected"))),
        react_1.default.createElement(Box_1.default, { alignItems: "center", display: "flex", flex: "3 0", height: "headerRowHeight", justifyContent: "flex-end", order: [2, 2] }, onSelect && singlePickedAsset && (react_1.default.createElement(Box_1.default, { display: "flex" },
            react_1.default.createElement(Button_1.default, { onClick: function () {
                    onSelect([
                        {
                            kind: 'assetDocumentId',
                            value: singlePickedAsset._id
                        }
                    ]);
                } }, "Select"))))));
};
exports.default = Footer;
